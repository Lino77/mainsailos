#!/bin/bash
set -xe
export LC_ALL=C

########################################
# Functions and Basic Configuration    #
########################################

# Load common functions and set up cleanup trap
source /common.sh
install_cleanup_trap

# Load additional configuration (e.g., BASE_USER)
source /files/00-config

########################################
# Configuration                        #
########################################

readonly REPO_RATOS="https://github.com/Rat-OS/RatOS-configurator.git"
readonly BRANCH_RATOS="dev-deployment"
readonly REPO_THEME="https://github.com/Rat-OS/RatOS-theme.git"
readonly BRANCH_THEME="v2.1.x"

RATOS_DEPS=(git python3-serial python3-opencv)

apt-get install --yes "${DEPS[@]}"


pushd "/home/${BASE_USER}/printer_data/config" &> /dev/null || exit 1
sudo -u "${BASE_USER}" git clone "${REPO_THEME}" -b "${BRANCH_THEME}" .theme
popd &> /dev/null || exit 1
pushd "/home/${BASE_USER}" &> /dev/null || exit 1
sudo -u "${BASE_USER}" git clone "${REPO_RATOS}" -b "${BRANCH_RATOS}" ratos-configurator
popd &> /dev/null || exit 1

# cp /root/etc/avahi/avahi-daemon.conf /etc/avahi/avahi-daemon.conf   
cp /files/ratos.log /var/log/ratos.log


# Set default git merge strategy
sudo -u "${BASE_USER}" git config --global pull.ff only

# Create release file
if [ -f "/etc/ratos_version" ]; then
    sudo rm -f /etc/ratos_version
fi
function get_parent {
    cat /etc/os-release | grep VERSION_CODENAME | cut -d '=' -f2
}

echo "${DIST_NAME} v${DIST_VERSION} ($(get_parent))" > "/etc/${DIST_NAME,,}-release"

## Step 3: Install system dependencies
apt-get update --allow-releaseinfo-change
# shellcheck disable=SC2086
apt-get install --yes ${RATOS_DEPS}
## END Step 3

# Install RatOS Configurator
sudo -u "${BASE_USER}" bash /home/"${BASE_USER}"/ratos-configurator/app/scripts/setup.sh

# Start the configurator so extensions can access the API
echo "Starting RatOS Configurator"
pushd "/home/${BASE_USER}/ratos-configurator"
sudo -u "${BASE_USER}" npm run start &
# Wait for configurator to start
# shellcheck disable=SC2016
timeout 300 bash -c 'while [[ "$(curl -s -o /dev/null -w ''%{http_code}'' localhost:3000)" != "404" ]]; do sleep 5; done' || false
popd

echo "RATOS CLI SANITY CHECKS"
echo $PATH
ls -la /usr/local/bin

# Install RatOS Configuration
sudo -u "${BASE_USER}" /home/"${BASE_USER}"/printer_data/config/RatOS/scripts/ratos-install.sh

# Create variant file
echo "${BASE_DISTRO}" > /etc/"${BASE_DISTRO}"-variant

# MOTD: RatOS logo
cat << EOF > /etc/motd
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ£€[0m[38;5;0mâ¡€[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ˜[0m[38;5;15mâ£¿[0m[38;5;145mâ£·[0m[38;5;0mâ£¦[0m[38;5;0mâ£„[0m[38;5;0mâ£€[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;102mâ ¹[0m[38;5;15mâ£·[0m[38;5;0mâ¡€[0m[38;5;188mâ¢‰[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;70mâ£¦[0m[38;5;0mâ£„[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;188mâ¢¹[0m[38;5;15mâ£·[0m[38;5;145mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;70mâ£‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;15mâ¢»[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ¢ [0m[38;5;0mâ¡€[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ˆ[0m[38;5;15mâ¢¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;70mâ£¦[0m[38;5;0mâ¡€[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ˜[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ ‹[0m[38;5;15mâ¢¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;59mâ ¸[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;0mâ¡€[0m[38;5;0mâ ˆ[0m[38;5;15mâ¢¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;76mâ¢¹[0m[38;5;22mâ£¦[0m[38;5;0mâ¡€[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;145mâ ¹[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£·[0m[38;5;0mâ£„[0m[38;5;0mâ¢¸[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;70mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;28mâ£†[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;15mâ¢»[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;102mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;70mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;15mâ¢¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;70mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ¡¿[0m[38;5;82mâ ƒ[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ˆ[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;70mâ ¼[0m[38;5;82mâ ‹[0m[38;5;22mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ’[0m[38;5;0mâ ’[0m[38;5;0mâ ’[0m[38;5;0mâ š[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡‡[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ¢€[0m[38;5;0mâ ¤[0m[38;5;0mâ ’[0m[38;5;59mâ Š[0m[38;5;188mâ¢¹[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ¢¸[0m[38;5;82mâ£¿[0m[38;5;82mâ Ÿ[0m[38;5;82mâ [0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ¢€[0m[38;5;0mâ ”[0m[38;5;188mâ [0m[38;5;188mâ ¹[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;22mâ ˜[0m[38;5;82mâ [0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;145mâ [0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;145mâ ™[0m[38;5;15mâ¢¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;15mâ£¿[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ£¿[0m[38;5;82mâ¡¿[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ ²[0m[38;5;0mâ£¶[0m[38;5;0mâ£¶[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;82mâ£¿[0m[38;5;82mâ Ÿ[0m[38;5;76mâ [0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m
[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;102mâ ™[0m[38;5;15mâ ›[0m[38;5;59mâ €[0m[38;5;0mâ €[0m[38;5;76mâ [0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m[38;5;0mâ €[0m

EOF


########################################
# Return to last directory             #
########################################

popd &> /dev/null || exit 1
